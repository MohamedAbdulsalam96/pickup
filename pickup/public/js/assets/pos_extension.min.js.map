{"version":3,"file":"pos_extension.min.js","sources":["../../../../../apps/pickup/pickup/pickup/custom_scripts/pos.js","../../../../../apps/pickup/pickup/public/js/controllers/taxes_and_totals.js","../../../../../apps/pickup/pickup/public/js/payment/payments.js"],"sourcesContent":["// Copyright (c) 2018, Britlog and contributors\n// For license information, please see license.txt\n\nerpnext.pos.PointOfSale = erpnext.pos.PointOfSale.extend({\n\n\tmake_customer: function (wrapper) {\n\t\tthis._super(wrapper);\n\t\tthis.list_customers_btn = this.page.wrapper.find('.list-customers-btn');\n\t\tthis.list_customers_btn.after($('<button class=\"btn btn-default get-orders-btn\" style=\"margin-left: 12px\"><i class=\"octicon octicon-gift\"></i></button>'));\n\t\tthis.get_customer_orders();\n\t},\n\n\tget_customer_orders: function (wrapper) {\n\t\tvar me = this;\n\t\tthis.get_orders_btn = this.page.wrapper.find('.get-orders-btn');\n\n\t\tthis.page.wrapper.on('click', '.get-orders-btn', function(wrapper) {\n\t\t\tme.customer_validate();\n\n\t\t\tfrappe.call({\n\t\t\t\tmethod: 'pickup.pickup.doctype.pickup_slot.pickup_slot.get_items_from_sales_order',\n\t\t\t\targs: {\n\t\t\t\t\t'customer': me.frm.doc.customer,\n\t\t\t\t\t'pickup_slot': me.pos_profile_data.pickup_slot\n\t\t\t\t},\n\t\t\t\tcallback: function(r) {\n\t\t\t\t\t//console.log(r.message);\n\n\t\t\t\t\t(r.message || []).forEach(function(row){\n\t\t\t\t\t\tme.items = me.get_items(row.item_code)\n\t\t\t\t\t\tme.add_to_cart();\n\t\t\t\t\t\tif (row.qty != 1) {\n\t\t\t\t\t\t\tme.update_qty(row.item_code, row.qty);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tme.child.uom = row.uom;\n\t\t\t\t\t\tme.child.conversion_factor = row.conversion_factor;\n\t\t\t\t\t\tme.set_item_details(row.item_code, \"rate\", row.rate);\n\t\t\t\t\t\tme.update_value();\n\t\t\t\t\t})\n\t\t\t\t}\n\t\t\t})\n//\t\t\t$(\".get-orders-btn\").prop(\"disabled\",true);\n\t\t})\n\t},\n})","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// License: GNU General Public License v3. See license.txt\n\nerpnext.taxes_and_totals.prototype.calculate_outstanding_amount = function(update_paid_amount) {\n\t// NOTE:\n\t// paid_amount and write_off_amount is only for POS Invoice\n\t// total_advance is only for non POS Invoice\n\n\tif(this.frm.doc.doctype == \"Sales Invoice\" && this.frm.doc.is_return){\n\t\tthis.calculate_paid_amount();\n\t}\n\n\tif(this.frm.doc.is_return || this.frm.doc.docstatus > 0) return;\n\n\tfrappe.model.round_floats_in(this.frm.doc, [\"grand_total\", \"total_advance\", \"write_off_amount\"]);\n\n\tif(in_list([\"Sales Invoice\", \"Purchase Invoice\"], this.frm.doc.doctype)) {\n\t\tvar grand_total = this.frm.doc.rounded_total || this.frm.doc.grand_total;\n\n\t\tif(this.frm.doc.party_account_currency == this.frm.doc.currency) {\n\t\t\tvar total_amount_to_pay = flt((grand_total - this.frm.doc.total_advance\n\t\t\t\t- this.frm.doc.write_off_amount + this.frm.doc.balance_amount), precision(\"grand_total\"));\n\t\t} else {\n\t\t\tvar total_amount_to_pay = flt(\n\t\t\t\t(flt(grand_total*this.frm.doc.conversion_rate, precision(\"grand_total\"))\n\t\t\t\t\t- this.frm.doc.total_advance - this.frm.doc.base_write_off_amount)\n\t\t\t\t\t+ this.frm.doc.balance_amount, precision(\"base_grand_total\")\n\t\t\t);\n\t\t}\n\n\t\tfrappe.model.round_floats_in(this.frm.doc, [\"paid_amount\"]);\n\t\tthis.set_in_company_currency(this.frm.doc, [\"paid_amount\"]);\n\n\t\tif(this.frm.refresh_field){\n\t\t\tthis.frm.refresh_field(\"paid_amount\");\n\t\t\tthis.frm.refresh_field(\"base_paid_amount\");\n\t\t}\n\n\t\tif(this.frm.doc.doctype == \"Sales Invoice\") {\n\t\t\tthis.set_default_payment(total_amount_to_pay, update_paid_amount);\n\t\t\tthis.calculate_paid_amount();\n\t\t}\n\t\tthis.calculate_change_amount();\n\n\t\tvar paid_amount = (this.frm.doc.party_account_currency == this.frm.doc.currency) ?\n\t\t\tthis.frm.doc.paid_amount : this.frm.doc.base_paid_amount;\n\n\t\tthis.frm.doc.outstanding_amount =  flt(total_amount_to_pay - flt(paid_amount) +\n\t\t\tflt(this.frm.doc.change_amount * this.frm.doc.conversion_rate), precision(\"outstanding_amount\"));\n\t}\n}\n\nerpnext.taxes_and_totals.prototype.calculate_change_amount = function(){\n\tthis.frm.doc.change_amount = 0.0;\n\tthis.frm.doc.base_change_amount = 0.0;\n\tif(this.frm.doc.doctype == \"Sales Invoice\"\n\t\t&& this.frm.doc.paid_amount > (this.frm.doc.grand_total + this.frm.doc.balance_amount)\n\t\t&& !this.frm.doc.is_return) {\n\n\t\tvar payment_types = $.map(this.frm.doc.payments, function(d) { return d.type; });\n\t\tif (in_list(payment_types, 'Cash')) {\n\t\t\tvar grand_total = this.frm.doc.rounded_total || this.frm.doc.grand_total;\n\t\t\tvar base_grand_total = this.frm.doc.base_rounded_total || this.frm.doc.base_grand_total;\n\n\t\t\tthis.frm.doc.change_amount = flt(this.frm.doc.paid_amount - grand_total +\n\t\t\t\tthis.frm.doc.write_off_amount - this.frm.doc.balance_amount, precision(\"change_amount\"));\n\n\t\t\tthis.frm.doc.base_change_amount = flt(this.frm.doc.base_paid_amount -\n\t\t\t\tbase_grand_total + this.frm.doc.base_write_off_amount -\tthis.frm.doc.balance_amount,\n\t\t\t\tprecision(\"base_change_amount\"));\n\t\t}\n\t}\n}\n\nerpnext.taxes_and_totals.prototype.calculate_write_off_amount = function(){\n\tif(this.frm.doc.paid_amount > this.frm.doc.grand_total){\n\t\tthis.frm.doc.write_off_amount = flt(this.frm.doc.grand_total - this.frm.doc.paid_amount\n\t\t\t+ this.frm.doc.change_amount + this.frm.doc.balance_amount, precision(\"write_off_amount\"));\n\n\t\tthis.frm.doc.base_write_off_amount = flt(this.frm.doc.write_off_amount * this.frm.doc.conversion_rate,\n\t\t\tprecision(\"base_write_off_amount\"));\n\t}else{\n\t\tthis.frm.doc.paid_amount = 0.0;\n\t}\n\tthis.calculate_outstanding_amount(false);\n}\n\n","// Copyright (c) 2015, Frappe Technologies Pvt. Ltd. and Contributors\n// License: GNU General Public License v3. See license.txt\n\n// new function\nerpnext.payments.prototype.balance_amount = function(balance_amount) {\n\tvar me = this;\n\n\tthis.frm.doc.balance_amount = flt(balance_amount, precision(\"balance_amount\"));\n\tthis.calculate_outstanding_amount(false)\n\tthis.show_amounts()\n}\n\nerpnext.payments.prototype.get_customer_balance = function(customer) {\n\tvar me = this;\n\n\tfrappe.call({\n\t\tmethod: 'pickup.pickup.custom_classes.pos.get_customer_balance',\n\t\targs: {\n\t\t\t'customer': customer\n\t\t},\n\t\tcallback: function(r) {\n//\t\t\tconsole.log(r.message);\n\n\t\t\tvar balance = flt(r.message);\n\t\t\tif (balance > 0)\n\t\t\t\t$(me.$body).find('#customer-balance-label').text(__(\"Solde (DÃ»)\"));\n\t\t\telse\n\t\t\t\t$(me.$body).find('#customer-balance-label').text(__(\"Solde (Avoir)\"));\n\n\t\t\t$(me.$body).find('#customer-balance').text(format_currency(balance, me.frm.doc.currency)).val(balance);\n\t\t}\n\t})\n}\n\n// override functions\nerpnext.payments.prototype.set_payment_primary_action = function(){\n\tvar me = this;\n\n\tthis.dialog.set_primary_action(__(\"Submit\"), function() {\n\t\tme.dialog.hide();\n\t\tme.submit_invoice();\n\t})\n}\n\nerpnext.payments.prototype.show_payment_details = function(){\n\tvar me = this;\n\tvar multimode_payments = $(this.$body).find('.multimode-payments').empty();\n\tif(this.frm.doc.payments.length){\n\t\t$.each(this.frm.doc.payments, function(index, data){\n\t\t\t$(frappe.render_template('payment_details', {\n\t\t\t\tmode_of_payment: data.mode_of_payment,\n\t\t\t\tamount: data.amount,\n\t\t\t\tidx: data.idx,\n\t\t\t\tcurrency: me.frm.doc.currency,\n\t\t\t\ttype: data.type\n\t\t\t})).appendTo(multimode_payments)\n\n\t\t\tif (data.type == 'Cash' && data.amount == me.frm.doc.paid_amount) {\n\t\t\t\tme.idx = data.idx;\n\t\t\t\tme.selected_mode = $(me.$body).find(repl(\"input[idx='%(idx)s']\",{'idx': me.idx}));\n\t\t\t\tme.highlight_selected_row();\n\t\t\t\tme.bind_amount_change_event();\n\t\t\t}\n\t\t})\n\t}else{\n\t\t$(\"<p>No payment mode selected in pos profile</p>\").appendTo(multimode_payments)\n\t}\n\n\t//Get customer balance value\n\tme.get_customer_balance(me.frm.doc.customer);\n\n}\n\nerpnext.payments.prototype.set_outstanding_amount = function(){\n\tthis.selected_mode = $(this.$body).find(repl(\"input[idx='%(idx)s']\",{'idx': this.idx}));\n\tthis.highlight_selected_row()\n\tthis.payment_val = 0.0\n\tif(this.frm.doc.outstanding_amount > 0 && flt(this.selected_mode.val()) == 0.0){\n\t\t//When user first time click on row\n\t\tthis.payment_val = flt(this.frm.doc.outstanding_amount / this.frm.doc.conversion_rate, precision(\"outstanding_amount\"))\n\n\t\tif(this.idx == 'balance_amount'){\n\t\t\tthis.selected_mode.val(format_currency($(this.$body).find('#customer-balance').val(), this.frm.doc.currency));\n\t\t}else{\n\t\t\tthis.selected_mode.val(format_currency(this.payment_val, this.frm.doc.currency));\n\t\t\tthis.update_payment_amount();\n\t\t}\n\n\t}else if(flt(this.selected_mode.val()) > 0){\n\t\t//If user click on existing row which has value\n\t\tthis.payment_val = flt(this.selected_mode.val());\n\t}\n\tthis.selected_mode.select()\n\tthis.bind_amount_change_event();\n}\n\t\nerpnext.payments.prototype.bind_form_control_event = function(){\n\tvar me = this;\n\t$(this.$body).find('.pos-payment-row').click(function(){\n\t\tme.idx = $(this).attr(\"idx\");\n\t\tme.set_outstanding_amount()\n\t})\n\n\t$(this.$body).find('.form-control').click(function(){\n\t\tme.idx = $(this).attr(\"idx\");\n\t\tme.set_outstanding_amount();\n\t\tme.update_paid_amount(true);\n\t})\n\n\t$(this.$body).find('.write_off_amount').change(function(){\n\t\tme.write_off_amount(flt($(this).val()), precision(\"write_off_amount\"));\n\t})\n\n\t$(this.$body).find('.change_amount').change(function(){\n\t\tme.change_amount(flt($(this).val()), precision(\"change_amount\"));\n\t})\n\n\t$(this.$body).find('.balance_amount').change(function(){\n\t\tme.balance_amount(flt($(this).val()), precision(\"balance_amount\"));\n\t})\n}\n\nerpnext.payments.prototype.update_paid_amount = function(update_write_off) {\n\tvar me = this;\n\tif(in_list(['change_amount', 'write_off_amount', 'balance_amount'], this.idx)){\n\t\tvar value = me.selected_mode.val();\n\t\tif(me.idx == 'change_amount'){\n\t\t\tme.change_amount(value)\n\t\t} else if(me.idx == 'write_off_amount'){\n\t\t\tif(flt(value) == 0 && update_write_off && me.frm.doc.outstanding_amount > 0) {\n\t\t\t\tvalue = flt(me.frm.doc.outstanding_amount / me.frm.doc.conversion_rate, precision(me.idx));\n\t\t\t}\n\t\t\tme.write_off_amount(value)\n\t\t} else {\n\t\t\tme.balance_amount(value)\n\t\t}\n\t}else{\n\t\tthis.update_payment_amount()\n\t}\n}\n\nerpnext.payments.prototype.show_amounts = function(){\n\tvar me = this;\n\t$(this.$body).find(\".write_off_amount\").val(format_currency(this.frm.doc.write_off_amount, this.frm.doc.currency));\n\t$(this.$body).find('.paid_amount').text(format_currency(this.frm.doc.paid_amount, this.frm.doc.currency));\n\t$(this.$body).find('.change_amount').val(format_currency(this.frm.doc.change_amount, this.frm.doc.currency))\n\t$(this.$body).find('.outstanding_amount').text(format_currency(this.frm.doc.outstanding_amount, frappe.get_doc(\":Company\", this.frm.doc.company).default_currency))\n\t$(this.$body).find(\".balance_amount\").val(format_currency(this.frm.doc.balance_amount, this.frm.doc.currency));\n\tthis.update_invoice();\n}"],"names":["erpnext","pos","PointOfSale","extend","make_customer","wrapper","this","_super","list_customers_btn","page","find","after","$","get_customer_orders","me","get_orders_btn","on","customer_validate","frappe","call","method","args","customer","frm","doc","pickup_slot","pos_profile_data","callback","r","message","forEach","row","items","get_items","item_code","add_to_cart","qty","update_qty","child","uom","conversion_factor","set_item_details","rate","update_value","taxes_and_totals","prototype","calculate_outstanding_amount","update_paid_amount","doctype","is_return","calculate_paid_amount","docstatus","model","round_floats_in","in_list","grand_total","rounded_total","party_account_currency","currency","total_amount_to_pay","flt","total_advance","write_off_amount","balance_amount","precision","conversion_rate","base_write_off_amount","set_in_company_currency","refresh_field","set_default_payment","calculate_change_amount","paid_amount","base_paid_amount","outstanding_amount","change_amount","base_change_amount","payment_types","map","payments","d","type","base_grand_total","base_rounded_total","calculate_write_off_amount","show_amounts","get_customer_balance","balance","$body","text","__","format_currency","val","set_payment_primary_action","dialog","set_primary_action","hide","submit_invoice","show_payment_details","multimode_payments","empty","length","each","index","data","render_template","mode_of_payment","amount","idx","appendTo","selected_mode","repl","highlight_selected_row","bind_amount_change_event","set_outstanding_amount","payment_val","update_payment_amount","select","bind_form_control_event","click","attr","change","update_write_off","value","get_doc","company","default_currency","update_invoice"],"mappings":"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"}